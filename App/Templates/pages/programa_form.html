<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>{% if programa %}Editar Programa{% else %}Crear Programa{% endif %}</title>
</head>
<body>
  <h2>{% if programa %}Editar Programa{% else %}Crear Programa{% endif %}</h2>
  <form method="post">
    {% csrf_token %}
    <label>Nombre</label>
    <input type="text" name="nombre" value="{{ programa.nombre|default:'' }}" required>

    <label>Descripci√≥n</label>
    <textarea name="descripcion">{{ programa.descripcion|default:'' }}</textarea>

    {% if programa %}
      <h3>Asignar Operadores</h3>
      {% for u in operadores %}
        <label>
          <input
            type="checkbox"
            name="operadores"
            value="{{ u.id }}"
            {% if u in programa.operadores.all %}checked{% endif %}
          >
          {{ u.username }} ({{ u.perfilusuario.rol }})
        </label><br>
      {% empty %}
        <p>No hay operadores disponibles.</p>
      {% endfor %}

      <h3>Asignar Productores</h3>
      {% for u in productores %}
        <label>
          <input
            type="checkbox"
            name="productores"
            value="{{ u.id }}"
            {% if u in programa.productores.all %}checked{% endif %}
          >
          {{ u.username }} ({{ u.perfilusuario.rol }})
        </label><br>
      {% empty %}
        <p>No hay productores disponibles.</p>
      {% endfor %}
    {% endif %}

    <button type="submit">{% if programa %}Guardar{% else %}Crear{% endif %}</button>
  </form>
</body>
</html>
