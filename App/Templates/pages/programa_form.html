{% extends "index.html" %}
{% load static %}

{% block title %}
  {% if programa %}Editar Programa{% else %}Crear Programa{% endif %}
{% endblock %}

{% block contenido %}
<link rel="stylesheet" href="{% static 'css/retro.css' %}">

<div class="retro-container">

  <h2 class="retro-title">
    {% if programa %}Editar Programa{% else %}Crear Programa{% endif %}
  </h2>

  <form method="post" class="retro-form">
    {% csrf_token %}

    <label class="retro-label">Nombre</label>
    <input
      type="text"
      name="nombre"
      value="{{ programa.nombre|default:'' }}"
      class="retro-input"
      required
    >

    <label class="retro-label">Descripci√≥n</label>
    <textarea
      name="descripcion"
      class="retro-textarea"
    >{{ programa.descripcion|default:'' }}</textarea>

    {% if programa %}
      <h3 class="retro-subtitle">Asignar Operadores</h3>

      <div class="retro-checkbox-list">
        {% for u in operadores %}
          <label class="retro-checkbox-item">
            <input
              type="checkbox"
              name="operadores"
              value="{{ u.id }}"
              {% if u in programa.operadores.all %}checked{% endif %}
            >
            <span>{{ u.username }} ({{ u.perfilusuario.rol }})</span>
          </label>
        {% empty %}
          <p class="retro-empty">No hay operadores disponibles.</p>
        {% endfor %}
      </div>

      <h3 class="retro-subtitle">Asignar Productores</h3>

      <div class="retro-checkbox-list">
        {% for u in productores %}
          <label class="retro-checkbox-item">
            <input
              type="checkbox"
              name="productores"
              value="{{ u.id }}"
              {% if u in programa.productores.all %}checked{% endif %}
            >
            <span>{{ u.username }} ({{ u.perfilusuario.rol }})</span>
          </label>
        {% empty %}
          <p class="retro-empty">No hay productores disponibles.</p>
        {% endfor %}
      </div>
    {% endif %}

    <button type="submit" class="retro-button">
      {% if programa %}Guardar{% else %}Crear{% endif %}
    </button>

  </form>
</div>

{% endblock %}
